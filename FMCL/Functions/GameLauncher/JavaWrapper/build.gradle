/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * To learn more about Gradle by exploring our Samples at https://docs.gradle.org/8.6/samples
 */
plugins{
    id 'java'
    id 'com.github.johnrengelman.shadow' version '7.1.2'
}

jar{
    manifest {
      attributes(
        'Main-Class': 'fmcl.javawrapper.Wrapper',
        'Add-Opens': 'java.base/jdk.internal.loader'
    )
   }
}

task copyLibs(type: Copy){
    from "build/libs/JavaWrapper.jar"
    into ".."
}

task compileC(type: Exec){
    commandLine "gcc",
                "-shared",
                "-o",
                "../JavaWrapper.dll",
                '-I"%JAVA_HOME%/include"',
                '-I"%JAVA_HOME%/include/win32"',
                "Wrapper.c"
}

//build.dependsOn compileC
//build.finalizedBy copyLibs

dependencies {
  implementation 'com.google.code.gson:gson:2.11.0'
}